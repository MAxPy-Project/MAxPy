<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Basic tutorial &mdash; MAxPy 0.1 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Case Study: Sobel Edge Detection" href="case_study_sobel.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MAxPy
              <img src="_static/logo-maxpy.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Basic tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-problem">The problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-rtl-design">The RTL design</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compiling-with-maxpy">Compiling with MAxPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-the-testbench">Writing the testbench</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exploring-approximate-adders">Exploring approximate adders</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exploring-approximate-multipliers">Exploring approximate multipliers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-probabilistic-pruning">Using probabilistic pruning</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="case_study_sobel.html">Case Study: Sobel Edge Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="case_study_fft.html">Case Study: FFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="case_study_jpeg.html">Case Study: JPEG</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MAxPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Basic tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/basic_tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="basic-tutorial">
<h1>Basic tutorial<a class="headerlink" href="#basic-tutorial" title="Permalink to this headline">¶</a></h1>
<p>This basic tutorial covers the basic functions of the MAxPy framework. By the end of it, you will be able to understand how MAxPy works and its available tools. Then, you can use the framework to develop and optimize your own circuits.</p>
<p>The code used for this tutorial is available <a class="reference external" href="https://github.com/MAxPy-Project/MAxPy-Tutorial">here</a>.</p>
<div class="section" id="the-problem">
<h2>The problem<a class="headerlink" href="#the-problem" title="Permalink to this headline">¶</a></h2>
<p>Suppose you want to make a hardware accelerator for a Polynomial Function of Degree 1: a <em>linear function</em>. The operation is pretty straightforward: the <span class="math notranslate nohighlight">\(y(x)\)</span> output for any given <span class="math notranslate nohighlight">\(x\)</span> input is the factor <span class="math notranslate nohighlight">\(a\)</span> times the <span class="math notranslate nohighlight">\(x\)</span> input plus factor <span class="math notranslate nohighlight">\(b\)</span>, as shown in the equation below.</p>
<div class="math notranslate nohighlight">
\[y(x) = a.x + b\]</div>
<p>As the equation shows, we can see that the linear function is performed by two arithmetic operations: <em>one sum</em> and <em>one multiplication</em>.</p>
<p>Now we are going to make some assumptions for our application:</p>
<ul class="simple">
<li><p>From now on, we will call our linear function circuit as <em>poly1</em>.</p></li>
<li><p>The circuit is going to have 3 inputs (<em>x</em>, <em>a</em> and <em>b</em>), and only one output (<em>y</em>);</p></li>
<li><p>Each of the three inputs will be <em>8 bits wide</em>, being the MSB the <em>signal bit</em> (values ranging from -128 to 127);</p></li>
<li><p>To cover all possibilites for data inputs, the output will be <em>16 bit wide</em>;</p></li>
<li><p>The application in which the linear function hardware accelerator will be used tolerates an error range of <em>10%</em>.</p></li>
</ul>
<p>Taking these assumptions into account, we can draw the following block diagram which represents our hardware accelerator:</p>
<a class="reference internal image-reference" href="_images/poly1-block.png"><img alt="_images/poly1-block.png" class="align-center" src="_images/poly1-block.png" style="width: 400px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="the-rtl-design">
<h2>The RTL design<a class="headerlink" href="#the-rtl-design" title="Permalink to this headline">¶</a></h2>
<p>Let’s write the <em>Verilog description</em> of our linear function hardware accelerator. Create anywhere in your system a directory called <code class="docutils literal notranslate"><span class="pre">poly1</span></code>, in which will put all design files used in this tutorial. From now on, we will call this the <em>working directory</em>. Inside the working directory, create a subdirectory named <code class="docutils literal notranslate"><span class="pre">rtl</span></code>, and create a new text file called <code class="docutils literal notranslate"><span class="pre">poly1.v</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>poly1
└── rtl
    └── poly1.v
</pre></div>
</div>
<p>The following code is the hardware description of our circuit, written in Verilog:</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="n">poly1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
    <span class="k">input</span> <span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">;</span>
    <span class="k">output</span> <span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">y</span><span class="p">;</span>
    <span class="k">assign</span> <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
<span class="k">endmodule</span>
</pre></div>
</div>
</div>
<div class="section" id="compiling-with-maxpy">
<h2>Compiling with MAxPy<a class="headerlink" href="#compiling-with-maxpy" title="Permalink to this headline">¶</a></h2>
<p>Now we are going to compile the <em>poly1</em> module in MAxPy, but without any optimizations or approximations for now. The goal at this point is to make a functional module that we can use to write our testbench.</p>
<p>Create a <code class="docutils literal notranslate"><span class="pre">run1.py</span></code> file inside the working directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>poly1
├── rtl
│   └── poly1.v
└── run1.py
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">run1.py</span></code> is a Python script, which will be used to invoke MAxPy’s command. The content of the <code class="docutils literal notranslate"><span class="pre">run1.py</span></code> is the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">MAxPy</span> <span class="kn">import</span> <span class="n">maxpy</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">maxpy</span><span class="o">.</span><span class="n">AxCircuit</span><span class="p">(</span><span class="n">top_name</span><span class="o">=</span><span class="s2">&quot;poly1&quot;</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">rtl2py</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s2">&quot;exact&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now it’s time to run MAxPy’s command! Run the following lines in the terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> <span class="o">[</span>PATH_TO_WORKING_DIR<span class="o">]</span>/poly1
python run1.py
</pre></div>
</div>
<p>If everything is fine, you should see a terminal output like the following. In case of any error, please check the <a class="reference internal" href="installation.html"><span class="doc">Installation</span></a> section and review every step of this tutorial.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MAxPy - Version 0.0.1

------------------------------------------------------------------------------------
&gt;&gt;&gt; MAxPy rtl2py: converting Verilog RTL design &quot;poly1&quot; into Python module
&gt; Base &quot;rtl&quot;, Target &quot;exact&quot;
&gt; Start: 04-03-2023 22:48:39
&gt; Synth
&gt; Netlist estimated area: 110.887
&gt; Netlist estimated power = 5.066 uW
&gt; Netlist estimated maximum delay = 127.195 nS
&gt; Verilator
&gt; C++/Python Wrapper
&gt; C++ compilation
ninja: Entering directory `poly1_exact/&#39;
[11/11] Linking CXX shared module poly1.cpython-310-x86_64-linux-gnu.so
&gt;&gt; 3.8 seconds
&gt; Module check (should print module&#39;s name)
&gt; poly1
&gt; End: 04-03-2023 22:48:43
&gt;&gt;&gt; Circuit &quot;poly1&quot; converted successfully!
</pre></div>
</div>
</div>
<div class="section" id="writing-the-testbench">
<h2>Writing the testbench<a class="headerlink" href="#writing-the-testbench" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="exploring-approximate-adders">
<h2>Exploring approximate adders<a class="headerlink" href="#exploring-approximate-adders" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="exploring-approximate-multipliers">
<h2>Exploring approximate multipliers<a class="headerlink" href="#exploring-approximate-multipliers" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="using-probabilistic-pruning">
<h2>Using probabilistic pruning<a class="headerlink" href="#using-probabilistic-pruning" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="case_study_sobel.html" class="btn btn-neutral float-right" title="Case Study: Sobel Edge Detection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, MAxPy Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>